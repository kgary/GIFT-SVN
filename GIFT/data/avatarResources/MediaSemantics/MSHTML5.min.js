/*
 Copyright (c) 2012 Media Semantics, Inc.
 Portions (spinner) are copyright (c) 2011 Felix Gnass.
*/
function msEmbed(e,m,v,P,Q){var W=new MSHTML5Control(e,m,v,P,Q);"undefined"==typeof msEmbeddings&&(msEmbeddings=[]);msEmbeddings.push(W);var aa=onload;onload="function"!=typeof onload?function(){W.onPageLoad()}:function(){aa&&aa();W.onPageLoad()};W.realizeTopLevel().ctl=W}
function MSHTML5Control(e,m,v,P,Q){function W(){if(!qa){var a=document.getElementById(e);Ia.spin(a);qa=!0}}function aa(){qa&&(Ia.stop(),qa=!1)}function Za(){ctl.Presenting=!0==k.presenting;if($a||ab)ctl.Presenting=!1;for(var a in k.items){ctl.Focus=a;break}null==ctl.Focus&&ctl.Presenting&&(ctl.Presenting=!1);B("Firing onSceneLoaded("+e+")");"function"==typeof onSceneLoaded&&onSceneLoaded(e);B("Firing onPresentingChange("+e+","+ctl.Presenting+")");"function"==typeof onPresentingChange&&onPresentingChange(e,
ctl.Presenting);B("Firing onFocusChange("+e+","+ctl.Focus+")");"function"==typeof onFocusChange&&onFocusChange(e,ctl.Focus);J();ctl.timeout=setTimeout("ctl.onFrame()",1E3/k.fps)}function Ja(a){var c="",b;for(b in a.items){var d=a.items[b];if("character"==d.type){var g=b,r="",D="'"+e+"','"+g+"',",h=D+"'audioonloadstart'",K=D+"'audioonprogress'",q=D+"'audiooncanplaythrough'",w=D+"'audioonerror'",k=D+"'audioonstalled'",m=D+"'audioonloadedmetadata'",j=D+"'audioonplaying'",l=D+"'audioonended'",D=D+"'audioontimeupdate'",
d=Ka(d),r=r+('<div id="'+e+g+'Div" style="position:absolute; left:'+d.x+"px; top:"+d.y+"px; width:"+d.cx+"; height:"+d.cy+'">'),r=r+('<canvas id="'+e+g+'Canvas" width="'+d.cx+'" height="'+d.cy+'"></canvas>'),r=r+('<audio id="'+e+g+'Audio" onloadstart="msEvent('+h+')" onprogress="msEvent('+K+')" oncanplaythrough="msEvent('+q+')" onerror="msEvent('+w+')" onstalled="msEvent('+k+')" onloadedmetadata="msEvent('+m+')" onplaying="msEvent('+j+')" onended="msEvent('+l+')" ontimeupdate="msEvent('+D+')"/>'),
r=r+"</div>";f[g]={aImg:null,aImgShow:null,cxCharLeft:d.cxLeft,cyCharTop:d.cyTop,charCanvas:null,loadingAudio:!1,audioLoaded:!1,idMsg:null,idMsgNext:null,complete:!1};c+=r}else"image"==d.type?c+=renderImage(b,d):"text"==d.type?c+=renderText(b,d):"rectangle"==d.type?c+=renderRectangle(b,d):"button"==d.type?c+=renderButton(b,d):"grid"==d.type?(g=b,s="",s+='<div id="'+e+g+'Div" style="position:absolute; left:'+d.left+"px; top:"+d.top+"px; width:"+d.width+"; height:"+d.height+'">',s+='<div id="'+e+g+
'Inner" style="position:relative; left:0px; top:0px; width:'+d.width+"; height:"+d.height+'">',s+=Ja(d),s+="</div>",s+="</div>",c+=s):"slideshow"==d.type&&(c+=renderSlideshow(b,d))}return c}function Ka(a){var c=0,b=parseInt(a.left),d=parseInt(a.width);0>b&&(c=-b,d+=b,b=0);b+d>k.width&&(d=k.width-b);var g=0,e=parseInt(a.top),a=parseInt(a.height);0>e&&(g=-e,a+=e,e=0);e+a>k.height&&(a=k.height-e);return{cxLeft:c,cyTop:g,x:b,y:e,cx:d,cy:a}}function bb(a){for(var c in a.items){var b=a.items[c];q[c]=b;
b.id=c;b.parent=a;b.hasOwnProperty("items")&&bb(b,c)}}function ia(a){return q[a]?a:cb(k,a)}function cb(a,c){for(var b in a.items){var d=a.items[b];if(d.name==c)return b;if(d=cb(d,c))return d}return null}function F(a){try{console.log(a)}catch(c){}}function B(a){if(0<traceLevel)try{console.log(a)}catch(c){}}function La(a){a||F("Internal Error")}function R(a,c){for(var b in c.items)if(c.items[b].type==a)return b;return null}function ba(a,c){for(var b=c.parent;b;){if(b&&b.type==a)return b;b=c.parent}}
function Ma(a,c){if(null==c)return null;var b=R(a,c);if(b){var d=null,g;for(g in b.items)d=b.items[g];if(b=d)return b}return null}function Na(a){var c=!1,b;for(b in a.parent.items){if(c)return a.parent.items[b];a.parent.items[b]==a&&(c=!0)}return null}function Oa(a){var c=null,b;for(b in a.parent.items){if(a.parent.items[b]==a)return c;c=a.parent.items[b]}}function db(){var a=!0,c;for(c in f)f[c].complete||(a=!1);C&&(a=!1);if(a){a=!1;for(c in f)f[c].complete=!1,f[c].idMsg=f[c].idMsgNext,f[c].idMsgNext=
null,null==f[c].idMsg&&(a=!0),ra();a&&(c=ctl.Presenting,ctl.Presenting=!1,ra(),!1==ctl.Presenting&&0<L.length?(a=L.shift(),"play"==a.type?(ctl.Focus=a.data,ctl.Presenting="true",B("Playing from queue with: "+Focus)):"speak"==a.type&&(ctl.Text=a.data,ctl.Focus=ia("Speak"),ctl.Presenting="true",B("Speaking from queue with: "+ctl.Text)),B("Firing onQueueLengthChange("+e+","+L.length+")"),"function"==typeof onQueueLengthChange&&onQueueLengthChange(e,L.length),J(),a=!0):a=!1,a||(c!=ctl.Presenting&&(B("Firing onPresentingChange("+
e+","+ctl.Presenting+")"),"function"==typeof onPresentingChange&&onPresentingChange(ctl,ctl.Presenting)),ra(),ca(k),ja()));setTimeout(function(){eb()},1)}}function sa(a){var c=k,b;for(b in c.items)for(var d in c.items[b].items){var g=c.items[b].items[d];if("message"==g.type&&!0==g.idle&&g.character==a)return d}return null}function S(a){return void 0!=v?v+"/"+a:a}function Pa(a){var c="",b;b=v;null==ta&&(ta=document.createElement("a"));ta.href=b;b=ta.href;"https://"==b.substr(0,8)?(b=b.substr(8),c=
b.substr(0,b.indexOf("/"))):"http://"==b.substr(0,7)&&(b=b.substr(7),c=b.substr(0,b.indexOf("/")));b="";"https://"==a.substr(0,8)?(b=a.substr(8),b=b.substr(0,b.indexOf("/"))):"http://"==a.substr(0,7)&&(b=a.substr(7),b=b.substr(0,b.indexOf("/")));return""!=b&&""!=c&&b!=c?(temparray=a.split(b),salt=temparray.join(c)):a}function eb(){0<X.length&&F("Internal error 4");X=[];for(var a in f)X.push(a);0<X.length&&(a=X.pop(),fb(a))}function fb(a){var c=f[a].idMsg,b=q[c];if(b.external)if("function"!=typeof jQuery)F("jQuery required for external messages");
else if(null!=da)B("Already have an outstanding server request! Ignoring.");else{da=a;ua=c;a=b.url;if(void 0!=b.addvariables){b=b.addvariables.split(",");for(c=0;c<b.length;c++)a+="&"+b[c]+"="+escape(ctl[b[c]])}var d=Pa(a+"&callback=?");B("Calling "+d);$.ajax({url:d,data:{},dataType:"jsonp",success:function(a){for(var b in a){ea=a[b];break}gb(da,ua);ua=da=null},error:function(){F("Error calling "+d);ua=da=G=null;ctl.Presenting=!1}})}else ea=null,gb(a,c)}function gb(a,c){(N||C||G)&&F("Internal error 3");
var b=q[c],d;!0==b.idle?d=b:b.external?(Qa(a,c,b,ea),d=ea):(f[a].loadedAudio||Qa(a,c,b,null),d=b);var g=q[b.character];(N||C||G)&&F("Internal error 1");G=a;!f[a].charCanvas&&("replace"==g.mode&&g.width!=g.artwidth)&&(f[a].charCanvas=document.createElement("canvas"),f[a].charCanvas.height=g.artheight,f[a].charCanvas.width=g.artwidth,f[a].cyCharTop=0,f[a].cxCharLeft=0);t=1;p={};d&&(d.onframe&&d.onframe["0"])&&(va=b.external?Pa(b.url):null,x=c,z=a,eval(d.onframe["0"]),va=z=x=null);for(i in p);t--;0==
t&&Ra()}function Qa(a,c,b,d){d?(b=Pa(b.url),c=Sa(b,d.file),d=Sa(b,d.altfile)):(c=S(b.file),d=S(b.altfile));b=document.getElementById(e+a+"Audio");!b.canPlayType("audio/mp3")&&b.canPlayType("audio/ogg")&&(c=d);c?(b.pause(),b.src=c,b.autoplay=!1,b.load(),f[a].loadingAudio=!0,f[a].loadedAudio=!1):(f[a].loadingAudio=!1,f[a].loadedAudio=!0)}function Sa(a,c){var b=a.indexOf("cs.exe");return-1!=b?a.substr(0,b-1)+"html/"+c:null}function Ta(){t--;N&&0==t?Ua():C&&0==t?Va():G&&0==t&&Ra()}function O(a){return"object"==
typeof a&&a.hasOwnProperty("msvector")}function wa(){nAudio=0;for(idChar in f)f[idChar].loadingAudio&&nAudio++;return nAudio}function hb(a){f[a].loadingAudio=!1;f[a].loadedAudio=!0;var a=wa(),c;if(c=0==X.length)if(c=null==G){if(a=0==a){var b;a:{for(b in f)if(f[b].idMsgNext){b=!0;break a}b=!1}a=!b}c=a}c&&ib()}function Ra(){var a=G;G=null;f[a].aImg=p;p={};f[a].aImgShow=[];f[a].complete=!1;0<X.length?(a=X.pop(),fb(a)):0==wa()&&ib()}function ib(){Y=-1;jb(0);G=null;aa();if(ctl.Presenting)for(idChar in f)document.getElementById(e+
idChar+"Audio").play();ka=0;la=(new Date).getTime()}function xa(a){for(var c in a.items){var b=a.items[c];if("image"==b.type)p[c]=new Image,p[c].onload=function(){Ta()},t++,p[c].src=S(b.file);else if("button"==b.type)for(var d="backfile backoverfile backdownfile backdisabledfile backchosenfile forefile foreoverfile foredisabledfile forechosenfile".split(" "),g=0;g<d.length;g++)b[d[g]]&&(p[c+d[g]]=new Image,p[c+d[g]].onload=function(){Ta()},t++,p[c+d[g]].src=S(b[d[g]]));else"character"==b.type?(b=
sa(c),d=q[b],ya=1,z=c,x=b,eval(d.onframe["0"]),x=z=null,ya=0):"grid"==b.type?xa(b):"slideshow"==b.type&&xa(b.items[y])}}function Ua(){La(u==N);N=null;aa();ca(k);za(k.items[u]);var a;ma&&(a=document.getElementById(e+ma+"Div"),a.style.display="none");a=document.getElementById(e+u+"Div");a.style.display="block";p={};y&&(a=document.getElementById(e+y+"Div"),a.style.display="block");na=ma=null;eb()}function za(a){for(var c in a.items){var b=a.items[c];if("image"==b.type){var d=document.getElementById(e+
c+"Div"),g=Ka(b);d.style.background="url("+S(b.file)+") -"+g.cxLeft+"px -"+g.cyTop+"px no-repeat";d.style.backgroundSize=b.width+"px "+b.height+"px"}else if("button"==b.type)T(c);else if("character"==b.type){b=sa(c);d=q[b];Wa(c);f[c].aImg={};f[c].aImgShow=[];for(var r in p)b==r.substr(0,b.length)&&(f[c].aImg[r]=p[r]);z=c;x=b;eval(d.onframe["1"]);x=z=null;U&&kb(c,b);f[c].charCanvas&&lb(c);f[c].aImg=null;f[c].aImgShow=null}else if("grid"==b.type)za(b);else if("slideshow"==b.type){var D,h;for(h in b.items){D=
b.items[h];break}za(D)}}}function Va(){La(C==y);C=null;aa();za(q[y]);var a;na&&(a=document.getElementById(e+na+"Div"),a.style.display="none");a=document.getElementById(e+y+"Div");a.style.display="block";p={};na=ma=null;db()}function T(a){var c=q[a],b="backfile",d="forefile",g=c.xfore,r=c.yfore,f=!1,h,K;c.disabled?c.hideondisabled?f=!0:(h="backdisabledfile",c[h]&&(b=h),h="foredisabledfile",c[h]&&(d=h)):c.chosen?(h="backchosenfile",K="backoverfile",c[h]?b=h:c[K]&&(b=K),h="forechosenfile",K="foredownfile",
c[h]?d=h:c[K]&&(d=K)):c.over&&!c.down?(h="backoverfile",c[h]&&(b=h),h="foreoverfile",c[h]&&(d=h)):c.over&&c.down&&(h="backdownfile",c[h]&&(b=h),h="foreoverfile",c[h]&&(d=h),g=parseInt(c.xfore)+parseInt(c.xdown),r=parseInt(c.yfore)+parseInt(c.ydown));h=document.getElementById(e+a+"Back");c[b]&&(h.src=S(c[b]));if(a=document.getElementById(e+a+"Fore"))c[d]&&(a.src=S(c[d])),a.style.left=g+"px",a.style.top=r+"px",a.style.display=f?"none":"block"}function ra(){for(charid in f);}function Z(){var a=q[ctl.Focus];
if(null==a)F("Invalid Focus value "+ctl.Focus+" - ignoring!"),ctl.Presenting=!1;else if(a=a.type,"scene"==a){u=ctl.Focus;if(y=(Aa=R("slideshow",q[u]))?oa?oa:R("slide",q[Aa]):null)ctl.Focus=y,oa=null;E=(fa=R("sequence",q[y?y:u]))?V?V:R("step",q[fa]):null;null!=E&&(ctl.Focus=E,V=null);E=null;ja();H&&(ctl.Focus=H,H=null)}else if("slide"==a){if((a=ba("scene",ctl.Focus))&&a!=u)return oa=ctl.Focus,ctl.Focus=a,Z();y=ctl.Focus;if(E=(fa=R("sequence",q[y]))?V?V:R("step",q[fa]):null)Focus=E,V=null;E=null;ja()}else if("step"==
a){if((a=ba("slide",ctl.Focus))&&a!=y||(a=ba("scene",a))&&a!=u)return V=ctl.Focus,ctl.Focus=a,Z();E=ctl.Focus;ja()}else if("message"==a||"dialog"==a){if((a=ba("step",ctl.Focus))&&a!=E||(a=ba("slide",ctl.Focus))&&a!=y)return H=ctl.Focus,ctl.Focus=a,Z();if((a=ba("scene",ctl.Focus))&&a!=u)return H=n,Focus=(void 0).attributes.id,Z();H=ctl.Focus;ja()}}function ja(){var a=!0;for(idChar in f){var c=null;ctl.Presenting?(E?c=Ba(E,idChar):y?c=Ba(y,idChar):u&&(c=Ba(u,idChar)),null==c?c=sa(idChar):a=!1):c=sa(idChar);
c!=f[idChar].idMsg&&(f[idChar].idMsg?f[idChar].idMsgNext=c:f[idChar].idMsg=c)}a&&(ctl.Presenting=!1,ctl.PresentingCur=!1)}function Ba(a,c){var b=q[a],d=null,g;for(g in b.items){var e=b.items[g];if("message"==e.type&&e.character==c&&!e.idle){if(g==H)return H=null,g;var f=!0;e.condition&&(f=eval(e.condition));f&&!d&&(d=g)}else if("dialog"==e.type&&(null==H||H==g))H=null,d=Ba(g,c)}return d}function mb(){var a;return E&&(a=Na(q[E]))||y&&(a=Na(q[y]))||u&&!k.focusisland&&(a=Na(q[u]))?a.id:null}function nb(){var a;
if(E&&(a=Oa(q[E])))return a.id;if(y){a=Oa(q[y]);var c=Ma("step",a);c&&(a=c);if(a)return a.id}return u&&!k.focusisland&&(a=Oa(q[u]),(c=Ma("slideshow",a))&&(a=c),(c=Ma("sequence",a))&&(a=c),a)?a.id:null}function J(){var a=u,c=y,b=y;ma=u;na=y;V=oa=H=null;Z();ra();ca(k);if(u!=a){if($a||ab)ctl.Presenting=!1;W();(N||C||G)&&F("Internal error 2");N=u;t=1;p={};xa(q[N]);for(var d in p);t--;0==t&&Ua()}else if(y!=c){W();La(!N&&!C&&!G);C=y;t=1;p={};xa(q[y]);for(var g in p);t--;0==t&&Va();ca(k)}else E!=b&&ca(k);
for(idChar in f)if(c=f[idChar].idMsgNext)a=idChar,b=q[c],!b.idle&&!b.external&&Qa(a,c,b,null)}function ca(a){for(id in a.items)if(obj=a.items[id],"button"==obj.type){var c=obj.behavior;if(c){switch(c){case "start":obj.disabled=ctl.Presenting;break;case "stop":obj.disabled=!ctl.Presenting;break;case "next":obj.disabled=null==mb();break;case "previous":case "first":obj.disabled=null==nb();break;case "pause":obj.disabled=!(ctl.Presenting&&!ctl.Paused);break;case "resume":obj.disabled=!(ctl.Presenting&&
ctl.Paused);break;case "mute":obj.disabled=!ctl.Muted;break;case "unmute":obj.disabled=ctl.Muted}T(id)}}else obj.hasOwnProperty("items")&&ca(obj)}function ob(a){for(var c in a.items){var b=a.items[c];if("rectangle"==b.type){if(b.wash){var d=document.getElementById(e+b.id+"Wash").getContext("2d"),g=d.createLinearGradient(0,0,"horizontal"==b.wash?b.width:0,"vertical"==b.wash?b.height:0);g.addColorStop(0,b.fillcolor1);g.addColorStop(1,b.fillcolor2);d.fillStyle=g;d.fillRect(0,0,b.width,b.height);renderRectangle(c,
b)}}else("slideshow"==b.type||"slide"==b.type)&&ob(b)}}function Wa(a){U=!1;ga=ha=0;a=q[a];Ca=a.width;Da=a.height}function pb(a,c){for(var b=f[a].aImgShow,d=0;d<b.length;d++)if(b[d]==c)return;b.push(c)}function lb(a){var c=q[a];if(f[a].charCanvas){var b=document.getElementById(e+a+"Canvas");b.getContext&&(b=b.getContext("2d"),b.imageSmoothingEnabled=!0,b.clearRect(0,0,parseInt(c.width),parseInt(c.height)),b.drawImage(f[a].charCanvas,0,0,c.artwidth,c.artheight,0,0,parseInt(c.width),parseInt(c.height)))}}
function kb(a,c){var b=f[a].charCanvas?f[a].charCanvas:document.getElementById(e+a+"Canvas");if(b.getContext){var d=b.getContext("2d");d.clearRect(0,0,b.width,b.height);for(b=0;b<f[a].aImgShow.length;b++){var g=f[a].aImgShow[b],r=f[a].aImg[g];if(O(r)){var D=r.n,h=r.x,K=r.y,k,w=q[a];k=w.width/w.artwidth;var m=r.rx,p=r.ry,j=r.rn;if(r.morph)a:{var w=d,l=r.data,v=r.morph,z=f[a].aImg[c+r.morph].data,r=D,h=h-10*f[a].cxCharLeft,D=K-10*f[a].cyCharTop,K=k,y=p,B=j;w.fillStyle="rgba(0,0,0,100)";w.strokeStyle=
"rgba(0,0,0,100)";w.lineWidth=1;var t=k=p=j=0,u=0,x=0,E=0,G=0,H=0,J=0,C=0,M=0,L=l.frames[0],z=z.frames[0];if(L.length!=z.length)F("Tween fail - "+g+" -> "+v+" - lengths differ");else for(var A=void 0,I=void 0,l=qb(K,h/10-l.xView/10*K,D/10-l.yView/10*K,m,y,B),h=0;h<L.length;h++){A=L[h];I=z[h];if(A[0]!=I[0]){F("Tween fail - "+g+" -> "+v+" - "+A+" vs "+I);break a}switch(A[0]){case "lw":w.lineWidth=A[1]/10*K;break;case "fs":w.fillStyle="rgba("+A[1]+","+A[2]+","+A[3]+","+A[4]/100+")";break;case "ss":w.strokeStyle=
"rgba("+A[1]+","+A[2]+","+A[3]+","+A[4]/100+")";break;case "bp":w.beginPath();J=H=M=xN=t=k=x=u=0;break;case "m":u=A[1];x=A[2];C=I[1];M=I[2];xA=u+(C-u)*r/100;yA=x+(M-x)*r/100;w.moveTo(l.a*xA+l.c*yA+l.e,l.b*xA+l.d*yA+l.f);break;case "l":u=A[1];x=A[2];C=I[1];M=I[2];xA=u+(C-u)*r/100;yA=x+(M-x)*r/100;w.lineTo(l.a*xA+l.c*yA+l.e,l.b*xA+l.d*yA+l.f);break;case "b":7==A.length?(j=A[1],p=A[2],k=A[3],t=A[4],u=A[5],x=A[6]):(j=u-(k-u),p=x-(t-x),k=A[1],t=A[2],u=A[3],x=A[4]);7==I.length?(E=I[1],G=I[2],H=I[3],J=I[4],
C=I[5],M=I[6]):(E=C-(H-C),G=M-(J-M),H=I[1],J=I[2],C=I[3],M=I[4]);5==A.length&&7==I.length?(E=C-(H-C),G=M-(J-M)):7==A.length&&5==I.length&&(j=u-(k-u),p=x-(t-x));x1A=j+(E-j)*r/100;y1A=p+(G-p)*r/100;x2A=k+(H-k)*r/100;y2A=t+(J-t)*r/100;xA=u+(C-u)*r/100;yA=x+(M-x)*r/100;w.bezierCurveTo(l.a*x1A+l.c*y1A+l.e,l.b*x1A+l.d*y1A+l.f,l.a*x2A+l.c*y2A+l.e,l.b*x2A+l.d*y2A+l.f,l.a*xA+l.c*yA+l.e,l.b*xA+l.d*yA+l.f);break;case "c":w.closePath();break;case "s":w.stroke();break;case "f":w.fill()}}}else rb(d,g,r.data,D-
1,h-10*f[a].cxCharLeft,K-10*f[a].cyCharTop,k,m,p,j)}else{w=r.getAttribute("data-cyframe");D=r.getAttribute("data-n");h=r.getAttribute("data-x");K=r.getAttribute("data-y");d.drawImage(r,0,(D-1)*w,r.width,w,h-f[a].cxCharLeft,K-f[a].cyCharTop,r.width,w);for(w=1;3>=w;w++)g=r.getAttribute("data-exclude"+w),""!=g&&(g=g.split(","),d.clearRect(g[0]-f[a].cxCharLeft,g[1]-f[a].cyCharTop,g[2],g[3]))}}Wa(a)}}function rb(a,c,b,d,g,e,f,h,k,q){if(d>=b.frames.length)F("Frame out of bounds "+c+" "+d);else{a.fillStyle=
"rgba(0,0,0,100)";a.strokeStyle="rgba(0,0,0,100)";a.lineWidth=1.2;for(var w=c=0,m=0,p=0,j=0,l=0,d=b.frames[d],g=qb(f,g/10-b.xView/10*f,e/10-b.yView/10*f,h,k,q),e=0;e<d.length;e++)switch(b=d[e],b[0]){case "lw":a.lineWidth=1.2*b[1]/10*f;break;case "fs":a.fillStyle="rgba("+b[1]+","+b[2]+","+b[3]+","+b[4]/100+")";break;case "ss":a.strokeStyle="rgba("+b[1]+","+b[2]+","+b[3]+","+b[4]/100+")";break;case "bp":a.beginPath();p=m=l=j=0;break;case "m":j=b[1];l=b[2];a.moveTo(g.a*j+g.c*l+g.e,g.b*j+g.d*l+g.f);break;
case "l":j=b[1];l=b[2];a.lineTo(g.a*j+g.c*l+g.e,g.b*j+g.d*l+g.f);break;case "b":7==b.length?(c=b[1],w=b[2],m=b[3],p=b[4],j=b[5],l=b[6]):(c=j-(m-j),w=l-(p-l),m=b[1],p=b[2],j=b[3],l=b[4]);a.bezierCurveTo(g.a*c+g.c*w+g.e,g.b*c+g.d*w+g.f,g.a*m+g.c*p+g.e,g.b*m+g.d*p+g.f,g.a*j+g.c*l+g.e,g.b*j+g.d*l+g.f);break;case "c":a.closePath();break;case "s":a.stroke();break;case "f":a.fill()}}}function qb(a,c,b,d,g,e){var f={a:1,b:0,c:0,d:1};f.e=c;f.f=b;f.a=f.a/10*a;f.d=f.d/10*a;if(0!=e){f.e+=-(d/10+c);f.f+=-(g/10+
b);var a=Math.cos(3.1415926535*(-e/10)/180),h=Math.sin(3.1415926535*(-e/10)/180),k=-Math.sin(3.1415926535*(-e/10)/180),e=Math.cos(3.1415926535*(-e/10)/180);f.a=a*f.a+k*f.b;f.c=a*f.c+k*f.d;f.e=a*f.e+k*f.f;f.b=h*f.a+e*f.b;f.d=h*f.c+e*f.d;f.f=h*f.e+e*f.f;f.e+=d/10+c;f.f+=g/10+b}return f}function jb(a){if(!Xa){Xa=!0;var c=Y,b;for(b in f)if(!(G&&G!=b)&&!f[b].complete){var d=q[f[b].idMsg];var tmp=q[f[b].idMsg];if(d&&(d.external&&ea&&(d=ea),d&&d.onframe))for(var e in d.onframe)if(0!=e){var r=Math.floor(1E3*(e-1)/k.fps);r>Y&&
r<=a&&(Wa(b),z=b,x=f[b].idMsg,eval(d.onframe[e]),x=z=null,U&&kb(b,tmp.id),f[b].charCanvas&&lb(b))}}Y==c&&(Y=a);Xa=!1}}function yb(a){if(a=q[a]){a.toggleschosen&&(a.chosen=!a.chosen,T(a.id));a.stayschosen&&(a.chosen=!0,T(a.id));if(a.resetspeers)for(var c in a.parent.items){var b=a.parent.items[c];"button"==b.type&&b!=a&&(b.chosen=!1,T(b.id))}(c=a.onclick)&&eval(c)}}function Ea(a,c){var b=document.createElement(a||"div"),d;for(d in c)b[d]=c[d];return b}function Fa(a){for(var c=1,b=arguments.length;c<
b;c++)a.appendChild(arguments[c]);return a}function pa(a,c){for(var b in c){var d=a.style,e;a:{e=b;var f=a.style,k=void 0,h=void 0;if(void 0===f[e]){e=e.charAt(0).toUpperCase()+e.slice(1);for(h=0;h<sb.length;h++)if(k=sb[h]+e,void 0!==f[k]){e=k;break a}e=void 0}}d[e||b]=c[b]}return a}function tb(a){for(var c=1;c<arguments.length;c++){var b=arguments[c],d;for(d in b)void 0===a[d]&&(a[d]=b[d])}return a}function ub(a){for(var c={x:a.offsetLeft,y:a.offsetTop};a=a.offsetParent;)c.x+=a.offsetLeft,c.y+=a.offsetTop;
return c}ctl=this;var k=void 0,q=null;ctl.Presenting=!1;ctl.Focus="";ctl.Text="";ctl.Paused=!1;ctl.Muted=!1;traceLevel=2;var $a=navigator.userAgent.match(/iPhone/i),ab=navigator.userAgent.match(/iPad/i),vb=!1,wb=!1,Ga=!1,u=null,Aa=null,y=null,fa=null,E=null,ma=null,na=null,H=null,oa=null,V=null,N=null,C=null,G=null,t=0,p={},f={},X=[],z,x,ya=0,U,ha,ga,Ca,Da,Y=-1,ka=0,la=0,da=null,ua=null,ea=null,va=null,L=[],xb=!1,Ya=null,ta=null;this.realizeTopLevel=function(){document.write('<div id="'+e+'" style="top:0px; left:0px; width:'+
P+"px; height:"+Q+'px"></div>');var a=document.getElementById(e);s="";s+='<div id="'+e+'Stage" style="position:relative" width="'+P+'" height="'+Q+'">';s+="&nbsp;";s+="</div>";a.innerHTML=s;if(!DetectHTML5())return a;Ia=(new Ha({lines:11,length:7,width:4,radius:10,rotate:0,color:"#eeeeee",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:1,top:Q/2-17,left:P/2-17})).spin(a);var c=document.createElement("script");a.appendChild(c);c.src=S(m+".js");return a};var Ia=null,qa=!0;this.aDocLoaded=
function(){if(void 0==k&&(k=window[m+"_Dir"],void 0!=k))if(k.width!=P||k.height!=Q)F("Please adjust msEmbed to use a width and height of "+k.width+","+k.height+" as specified in project.");else{q={};k.type="project";k.parent=null;bb(k,"");parseInt(k.version.split(".")[3])&1&&(xb=!0);s="";for(var a in k.items)s+='<div id="'+e+a+'Div" style="display:none; left:0px; top:0px; position:absolute" width="'+P+'" height="'+Q+'">',s+='<div id="'+e+a+'Inner" style="left:0px; top:0px; position:relative" width="'+
P+'" height="'+Q+'">',s+=Ja(k.items[a]),renderBubble(),s+="</div>",s+="</div>";document.getElementById(e+"Stage").innerHTML=s;for(var c in k.items)ob(k.items[c]);if(a=document.getElementById("BubbleLayer")){a=a.getContext("2d");var b=c=0;for(c=0;c<10*P;c+=875)for(b=0;b<10*Q;b+=875){var d=a;Ya||(Ya={msvector:!0,data:{cx:"6120",cy:"7920",xView:"990",yView:"820",cxView:"1750",cyView:"1750",frames:[[["fs",35,31,32,50],["bp"],["m",1391,978],["l",1478,1065],["l",1438,1105],["l",1403,1070],["l",1365,1108],
["l",1398,1141],["l",1360,1179],["l",1327,1146],["l",1283,1190],["l",1321,1228],["l",1281,1268],["l",1190,1177],["l",1391,978],["c"],["f"],["bp"],["m",1621,1208],["l",1393,1383],["l",1314,1304],["l",1485,1073],["l",1540,1128],["b",1491,1190,1449,1241,1413,1282],["b",1454,1246,1492,1214,1525,1187],["l",1566,1153],["l",1621,1208],["c"],["f"],["bp"],["m",1717,1304],["l",1546,1535],["l",1493,1482],["l",1526,1443],["l",1507,1424],["l",1468,1457],["l",1414,1403],["l",1642,1228],["l",1717,1304],["c"],["m",
1560,1406],["b",1580,1381,1606,1350,1637,1314],["b",1593,1347,1562,1372,1542,1388],["l",1560,1406],["c"],["f"],["bp"],["m",1808,1395],["l",1647,1556],["l",1679,1588],["l",1639,1628],["l",1555,1544],["l",1756,1343],["l",1808,1395],["c"],["f"],["bp"],["m",1971,1559],["l",1837,1693],["b",1822,1708,1811,1718,1803,1724],["b",1796,1729,1787,1733,1775,1734],["b",1764,1736,1752,1734,1741,1729],["b",1719,1717,1708,1706],["b",1696,1694,1687,1681,1682,1668],["b",1677,1655,1675,1643,1677,1632],["b",1679,1621,
1683,1612,1689,1604],["b",1710,1581,1732,1558],["l",1851,1439],["l",1903,1491],["l",1753,1642],["b",1744,1651,1739,1657,1738,1660],["b",1737,1663,1737,1667,1740,1669],["b",1743,1672,1747,1673,1750,1671],["b",1754,1669,1760,1663,1771,1653],["l",1919,1505],["l",1971,1559],["c"],["f"],["bp"],["m",2082,1670],["l",1911,1901],["l",1858,1848],["l",1891,1809],["l",1872,1790],["l",1833,1823],["l",1779,1769],["l",2007,1594],["l",2082,1670],["c"],["m",1925,1771],["b",1945,1746,1971,1715,2002,1679],["b",1958,
1712,1927,1737,1907,1753],["l",1925,1771],["c"],["f"],["bp"],["m",2212,1800],["l",2172,1840],["l",2141,1809],["l",1980,1970],["l",1928,1918],["l",2089,1757],["l",2058,1726],["l",2098,1686],["l",2212,1800],["c"],["f"],["bp"],["m",2276,1864],["l",2075,2065],["l",2023,2013],["l",2224,1812],["l",2276,1864],["c"],["f"],["bp"],["m",2299,2122],["b",2279,2142,2264,2156,2255,2164],["b",2235,2176,2223,2178],["b",2211,2180,2199,2179,2187,2174],["b",2175,2169,2163,2161,2152,2150],["b",2141,2139,2133,2128,2128,
2116],["b",2121,2092,2123,2079],["b",2125,2067,2129,2056,2137,2047],["b",2144,2038,2158,2023,2179,2002],["l",2213,1968],["b",2233,1948,2248,1934,2257,1926],["b",2266,1919,2277,1914,2289,1912],["b",2301,1910,2313,1911,2325,1916],["b",2337,1921,2349,1929,2360,1940],["b",2371,1951,2379,1962,2384,1974],["b",2389,1986,2391,1998,2389,2011],["b",2387,2023,2383,2034,2375,2043],["b",2368,2052,2354,2067,2333,2088],["l",2299,2122],["c"],["m",2313,2004],["b",2322,1995,2328,1988,2329,1984],["b",2331,1980,2330,
1977,2327,1974],["b",2324,1971,2321,1970,2318,1971],["b",2307,1977,2297,1988],["l",2203,2082],["b",2191,2094,2185,2101,2183,2105],["b",2181,2109,2182,2112,2186,2116],["b",2190,2120,2193,2120,2198,2118],["b",2202,2116,2210,2109,2222,2097],["l",2313,2004],["c"],["f"],["bp"],["m",2553,2141],["l",2352,2342],["l",2306,2296],["l",2370,2177],["l",2279,2268],["l",2235,2224],["l",2436,2023],["l",2480,2067],["l",2419,2187],["l",2510,2096],["l",2553,2141],["c"],["f"]]]}});rb(d,"",Ya.data,0,c,b,0.5,0,0,0)}}vb=
!0;wb&&!Ga&&(Ga=!0,Za())}};renderImage=function(a,c){var b=Ka(c);return'<div id="'+e+a+'Div" style="position:absolute; left:'+b.x+"px; top:"+b.y+"px; width:"+b.cx+"px; height:"+b.cy+'px;"/></div>'};renderBubble=function(){xb&&(s+='<canvas id="BubbleLayer" style="position:absolute; left:0px; top:0px;" width="'+P+'" height="'+Q+'"/></canvas>')};renderText=function(a,c){var b;b=""+('<div id="'+e+a+'Div" style="position:absolute; left:'+c.left+"px; top:"+c.top+"px; width:"+c.width+"px; height:"+c.height+
'px">');b+=c.text;return b+"</div>"};renderRectangle=function(a,c){var b="";c.wash?b+='<canvas id="'+e+a+'Wash" style="position:absolute; left:'+c.left+"px; top:"+c.top+'px;" width="'+c.width+'" height="'+c.height+'"/></canvas>':(b+='<div id="'+e+a+'Div" style="position:absolute; left:'+c.left+"px; top:"+c.top+"px; width:"+c.width+"px; height:"+c.height+"px;",c.fillcolor&&(b+=" background-color:"+c.fillcolor+";"),0<c.strokewidth&&(b+=" border:"+c.strokewidth+"px solid "+c.strokecolor+";"),b+='"></div>');
return b};renderButton=function(a,c){var b;b=""+('<div id="'+e+a+'Div" style="position:absolute; left:'+c.left+"px; top:"+c.top+"px; width:"+c.width+"px; height:"+c.height+'px">');var d="'"+e+"','"+a+"',";b=b+('<a href="javascript:msEvent('+(d+"'buttonclick'")+')" onmouseover="msEvent('+(d+"'mouseover'")+')" onmouseout="msEvent('+(d+"'mouseout'")+')" onmousedown="msEvent('+(d+"'mousedown'")+')" onmouseup="msEvent('+(d+"'mouseup'")+')">')+('<div id="'+e+a+'Inner" style="position:relative; left:0px; top:0px; width:'+
c.width+"; height:"+c.height+'">');b+='<img id="'+e+a+'Back" style="position:absolute; left:0; top:0;" border="0"/>';c.text?b+='<span id="'+e+a+'Lbl" style="position:absolute; left:'+c.xfore+"px; top:"+c.yfore+'px;"/><font>'+c.text+"</font></span>":c.forefile&&(b+='<img id="'+e+a+'Fore" style="position:absolute; left:'+c.xfore+"px; top:"+c.yfore+'px;" border="0"/>');b+="</div>";b+="</a>";b+="</div>";c.over=!1;c.down=!1;return b};renderSlideshow=function(a,c){var b;b=""+('<div id="'+e+a+'Div" style="position:absolute; left:'+
c.left+"px; top:"+c.top+"px; width:"+c.width+"; height:"+c.height+'">');b+='<div id="'+e+a+'Inner" style="position:relative; left:0px; top:0px; width:'+c.width+"; height:"+c.height+'">';for(var d in c.items){var f=c.items[d];b+='<div id="'+e+d+'Div" style="display:none; position:absolute; left:0px; top:0px; width:'+c.width+"; height:"+c.height+';">';b+='<div id="'+e+d+'Inner" style="position:relative; left:0px; top:0px; width:'+c.width+"; height:"+c.height+';">';b+=Ja(f);b+="</div>";b+="</div>"}return b+=
"</div></div>"};this.aVectorLoaded=function(){nAudio=wa();for(var a in p){var c=p[a];O(c)&&null==c.data&&(c.data=window["MS"+c.digest],c.data&&t--)}N&&0==t?Ua():C&&0==t?Va():G&&0==t&&Ra()};this.startPresenting=function(){B("startPresenting");ctl.Presenting||(q[ctl.Focus]?(ctl.Presenting=!0,J()):F("startPresenting() - no valid messages available"))};this.restartPresenting=function(){B("restartPresenting");q[ctl.Focus]?(ctl.Presenting=!0,J()):F("restartPresenting() - no valid messages available")};
this.stopPresenting=function(){B("stopPresenting");ctl.Presenting&&(ctl.Presenting=!1,J())};this.msgoto=function(a){B("goto "+a);a=ia(a);ctl.Focus=a;J()};this.externalCommand=function(a,c){B("Firing onExternalCommand("+a+","+c+")");"function"==typeof onExternalCommand&&onExternalCommand(e,a,c)};this.nextFocus=function(){B("nextFocus");var a=mb();a?ctl.Focus=a:ctl.Presenting=!1;J()};this.previousFocus=function(){B("previousFocus");var a=nb();a&&(ctl.Focus=a,J())};this.firstFocus=function(){B("firstFocus");
var a;a=null;k.focusisland?null!=Aa?a=R("slide",q[Aa]):null!=fa&&(a=R("step",q[fa])):a=R("scene",k);a&&(ctl.Focus=a,J())};this.load=function(a,c,b,d,f,r){0!=ya&&r>ya||(a=x+a,b=va?Sa(va,c):S(c),".js"==c.substr(c.length-3)?(p[a]={},p[a].msvector=!0,p[a].digest=c.substr(0,c.length-3),window["MS"+p[a].digest]?p[a].data=window["MS"+p[a].digest]:(p[a].data=null,a=document.createElement("script"),document.getElementById(e).appendChild(a),t++,a.src=b)):(p[a]=new Image,p[a].onload=function(){Ta()},p[a].setAttribute("data-cyframe",
f),t++,p[a].src=b))};this.update=this.add=function(a,c,b,d,g,r,k){var h=0,m=0,p=1,w=0,u=0,v=0,j=f[z].aImg[x+a];if(null!=j){pb(z,x+a);7<=arguments.length?(h=c,m=b,p=d,w=g,u=r,v=k):4==arguments.length?(h=c,m=b,p=d,w=O(j)?j.rx:parseInt(j.getAttribute("data-rx")),u=O(j)?j.ry:parseInt(j.getAttribute("data-ry")),v=O(j)?j.rn:parseInt(j.getAttribute("data-rn"))):2==arguments.length&&(p=c,h=O(j)?j.x:parseInt(j.getAttribute("data-x")),m=O(j)?j.y:parseInt(j.getAttribute("data-y")),w=O(j)?j.rx:parseInt(j.getAttribute("data-rx")),
u=O(j)?j.ry:parseInt(j.getAttribute("data-ry")),v=O(j)?j.rn:parseInt(j.getAttribute("data-rn")));"infront"==q[z].mode&&(U=!0);var l;U||(l=parseInt(j.getAttribute("data-cyframe")),h>=ha&&h<=ha+Ca&&h+j.width>=ha&&h+j.width<=ha+Ca&&m>=ga&&m<=ga+Da&&m+l>=ga&&m+l<=ga+Da||(U=!0));if(!U){var t=f[z].charCanvas?f[z].charCanvas:document.getElementById(e+z+"Canvas");if(t.getContext){var y=t.getContext("2d");y.clearRect(h-f[z].cxCharLeft,m-f[z].cyCharTop,j.width,l);y.drawImage(j,0,(p-1)*l,j.width,l,h-f[z].cxCharLeft,
m-f[z].cyCharTop,j.width,l);for(t=7;arguments.length>t;)y.clearRect(arguments[t],arguments[t+1],arguments[t+2],arguments[t+3]),t+=4}else F("No canvas support.");ha=h;ga=m;Ca=j.width;Da=l}if(O(j))j.x=h,j.y=m,j.n=p,j.rx=w,j.ry=u,j.rn=v,j.morph=null;else{j.setAttribute("data-x",h);j.setAttribute("data-y",m);j.setAttribute("data-n",p);j.setAttribute("data-rx",w);j.setAttribute("data-ry",u);j.setAttribute("data-rn",v);t=7;for(h=1;3>=h;h++)m="",arguments.length>t&&(m=arguments[t]+","+arguments[t+1]+","+
arguments[t+2]+","+arguments[t+3]),j.setAttribute("data-exclude"+h,m),t+=4}}};this.updatetween=this.addtween=function(a,c,b,d,e,r,m,h){var k=0,p=0,q=0,t=0,u=0,j=0,l=f[z].aImg[x+a],v=f[z].aImg[x+c];l&&v&&(pb(z,x+a),8<=arguments.length?(k=b,p=d,q=e,t=r,u=m,j=h):5<=arguments.length?(k=b,p=d,q=e):3==arguments.length&&(q=b,k=l.x,p=l.y),l.x=k,l.y=p,l.n=q,l.rx=t,l.ry=u,l.rn=j,l.morph=c,U=!0)};this.rem=function(a){a:for(var a=x+a,c=f[z].aImgShow,b=0;b<c.length;b++)if(c[b]==a){c.splice(b,1);break a}U=!0};
this.stop=function(){var a=!1;q[x].idle&&null==f[z].idMsgNext&&(a=!0);a?(Y=-1,ka=0,la=(new Date).getTime()):(f[z].complete=!0,db(z))};this.rec=function(a){f[z].idMsgNext&&(f[idChar].aImgShow=[],a=Math.floor(1E3*(a-1)/k.fps),Y=a-1,ka=a,la=(new Date).getTime())};this.onPageLoad=function(){wb=!0;vb&&!Ga&&(Ga=!0,Za())};this.onFrame=function(){if(!N&&!C&&!G&&0==wa()&&null==da){var a=(new Date).getTime()-la+ka;jb(a)}ctl.timeout=setTimeout("ctl.onFrame()",1E3/k.fps)};var Xa=!1;this.msEvent=function(a,c){switch(c){case "audioonloadstart":break;
case "audioonprogress":break;case "audiooncanplaythrough":f[a].loadingAudio&&hb(a);break;case "audioonerror":var b=document.getElementById(e+a+"Audio");f[a].loadingAudio&&(F("Embedded character unable to play audio - will still move lips"+("object"==typeof b.error?" - code "+b.error.code:"")),hb(a));break;case "audioonstalled":break;case "audioonloadedmetadata":break;case "audioonplaying":break;case "audioonended":break;case "audioontimeupdate":b=document.getElementById(e+a+"Audio");0<b.currentTime&&
(ka=Math.floor(1E3*b.currentTime),la=(new Date).getTime());break;case "onload":onload(a);break;case "buttonclick":yb(a);break;case "mouseover":q[a].over=!0;T(a);break;case "mouseout":q[a].over=!1;T(a);break;case "mousedown":q[a].down=!0;T(a);break;case "mouseup":q[a].down=!1;T(a);break;default:F("unhandled event "+c)}};this.msSetTraceLevel=function(a){traceLevel=a};this.msPlay=function(a){B("msPlay('"+a+"')");a=ia(a);L=[];var c=ctl.Presenting;ctl.Presenting=!0;c!=ctl.Presenting&&(B("Firing onPresentingChange("+
e+","+ctl.Presenting+")"),"function"==typeof onPresentingChange&&onPresentingChange(e,ctl.Presenting));c=ctl.Focus;ctl.Focus=a;c!=ctl.Focus&&(B("Firing onFocusChange("+e+","+ctl.Focus+")"),"function"==typeof onFocusChange&&onFocusChange(e,ctl.Focus));!1!=ctl.Presenting&&(q[ctl.Focus]?J():F("msPlay() - unknown message "+a))};this.msSpeak=function(a){B("msSpeak('"+a+"')");L=[];ctl.Presenting=!0;ctl.Focus=ia("Speak");ctl.Text=a;q[ctl.Focus]?J():F("msSpeak() - no message named Speak in the project")};
this.msSpeakQueued=function(a){B("msSpeakQueued('"+a+"')");!ctl.Presenting&&!ctl.Restart?(ctl.Text=a,ctl.Focus=ia("Speak"),ctl.Presenting=!0,q[ctl.Focus]?J():F("msSpeakQueued() - no message named Speak in the project")):(L.push({type:"speak",data:a}),B("Firing onQueueLengthChange("+e+","+L.length+")"),"function"==typeof onQueueLengthChange&&onQueueLengthChange(e,L.length))};this.msStart=function(){B("msStart()");L=[];this.startPresenting()};this.msStop=function(){B("msStop()");L=[];this.stopPresenting()};
var sb=["webkit","Moz","ms","O"],zb=Ea("style");Fa(document.getElementsByTagName("head")[0],zb);var Ab={lines:12,length:7,width:5,radius:10,rotate:0,color:"#000",speed:1,trail:100,opacity:0.25,fps:20,zIndex:2E9,className:"spinner",top:"auto",left:"auto"},Ha=function c(b){if(!this.spin)return new c(b);this.opts=tb(b||{},c.defaults,Ab)};Ha.defaults={};tb(Ha.prototype,{spin:function(c){this.stop();var b=this,d=b.opts,e=b.el=pa(Ea(0,{className:d.className}),{position:"relative",zIndex:d.zIndex}),f=d.radius+
d.length+d.width,k,h;c&&(c.appendChild(e),h=ub(c),k=ub(e),pa(e,{left:("auto"==d.left?h.x-k.x+(c.offsetWidth>>1):d.left+f)+"px",top:("auto"==d.top?h.y-k.y+(c.offsetHeight>>1):d.top+f)+"px"}));e.setAttribute("aria-role","progressbar");b.lines(e,b.opts);var m=0,p=d.fps,q=p/d.speed,t=(1-d.opacity)/(q*d.trail/100),u=q/d.lines;!function l(){m++;for(var c=d.lines;c;c--){var f=Math.max(1-(m+c*u)%q*t,d.opacity);b.opacity(e,d.lines-c,f,d)}b.timeout=b.el&&setTimeout(l,~~(1E3/p))}();return b},stop:function(){var c=
this.el;c&&(clearTimeout(this.timeout),c.parentNode&&c.parentNode.removeChild(c),this.el=void 0);return this},lines:function(c,b){function d(c,d){return pa(Ea(),{position:"absolute",width:b.length+b.width+"px",height:b.width+"px",background:c,boxShadow:d,transformOrigin:"left",transform:"rotate("+~~(360/b.lines*e+b.rotate)+"deg) translate("+b.radius+"px,0)",borderRadius:(b.width>>1)+"px"})}for(var e=0,f;e<b.lines;e++)f=Ea(),f=pa(f,{position:"absolute",top:1+~(b.width/2)+"px",transform:b.hwaccel?"translate3d(0,0,0)":
"",opacity:b.opacity,animation:void 0}),b.shadow&&Fa(f,pa(d("#000","0 0 4px #000"),{top:"2px"})),Fa(c,Fa(f,d(b.color,"0 0 1px rgba(0,0,0,.1)")));return c},opacity:function(c,b,d){b<c.childNodes.length&&(c.childNodes[b].style.opacity=d)}});window.Spinner=Ha}function DetectHTML5(){var e=document.createElement("audio")||!1,e=e&&"undefined"!==typeof e.canPlayType,m=document.createElement("canvas"),m=!(!m.getContext||!m.getContext("2d"));return e&&m}
function msGetFlash(e){return-1!=navigator.appName.indexOf("Microsoft")?window[e]:document[e]}function msIsFlash(e){return"[object HTMLEmbedElement]"==e.toString()||"[object HTMLObjectElement]"==e.toString()}function msIsHTML5(e){return"[object HTMLDivElement]"==e.toString()&&e.hasOwnProperty("ctl")}function msDocLoaded(){for(var e=0;e<msEmbeddings.length;e++)msEmbeddings[e].aDocLoaded()}function msVectorLoaded(){for(var e=0;e<msEmbeddings.length;e++)msEmbeddings[e].aVectorLoaded()}
function msEvent(e,m,v){document.getElementById(e).ctl.msEvent(m,v)}function msPlay(e,m){var v=document.getElementById(e);null==v&&(v=msGetFlash(e));msIsFlash(v)?v.msPlay(m):msIsHTML5(v)&&v.ctl.msPlay(m)}function msSpeak(e,m){var v=document.getElementById(e);null==v&&(v=msGetFlash(e));msIsFlash(v)?v.msSpeak(m):msIsHTML5(v)&&v.ctl.msSpeak(m)}
function msSpeakQueued(e,m){var v=document.getElementById(e);null==v&&(v=msGetFlash(e));msIsFlash(v)?msGetFlash(e).msSpeakQueued(m):msIsHTML5(v)&&v.ctl.msSpeakQueued(m)}function msStart(e){var m=document.getElementById(e);null==m&&(m=msGetFlash(e));msIsFlash(m)?m.msStart():msIsHTML5(m)&&m.ctl.msStart()}function msStop(e){var m=document.getElementById(e);null==m&&(m=msGetFlash(e));msIsFlash(m)?m.msStop():msIsHTML5(m)&&m.ctl.msStop()}
function msSetTraceLevel(e,m){var v=document.getElementById(e);msIsHTML5(v)&&v.msSetTraceLevel(m)};